"use strict";
var core_1 = require("@angular/core");
var Sqlite = require("nativescript-sqlite");
var ChallengeService = (function () {
    function ChallengeService() {
        var _this = this;
        if (!Sqlite.exists("examen.db")) {
            Sqlite.copyDatabase("examen.db");
        }
        (new Sqlite("examen.db")).then(function (db) {
            db.execSQL("CREATE TABLE IF NOT EXISTS " +
                "challenges (id INTEGER PRIMARY KEY AUTOINCREMENT," +
                "  nom TEXT)")
                .then(function (id) {
                _this.database = db;
                _this.getAllChallenges();
            }, function (error) {
                console.log("CREATE TABLE ERROR", error);
            });
        }, function (error) {
            console.log("OPEN DB ERROR", error);
        });
        (new Sqlite("examen.db")).then(function (db) {
            db.execSQL("CREATE TABLE IF NOT EXISTS " +
                "challenges (id INTEGER PRIMARY KEY AUTOINCREMENT," +
                "  nom TEXT)")
                .then(function (id) {
                _this.database = db;
                _this.getAllChallenges();
            }, function (error) {
                console.log("CREATE TABLE ERROR", error);
            });
        }, function (error) {
            console.log("OPEN DB ERROR", error);
        });
    }
    ChallengeService.prototype.getAllChallenges = function () {
        var _this = this;
        this.database.all("SELECT * FROM challenges").then(function (rows) {
            _this.challenges = [];
            for (var row in rows) {
                _this.challenges.push({
                    id: rows[row][0],
                    nom: rows[row][1]
                });
                console.log("id: " + rows[row][0] + "  name: " + rows[row][1]);
            }
        }, function (error) {
            console.log("SELECT ERROR", error);
        });
    };
    ChallengeService.prototype.getAllMyChallenges = function () {
        var _this = this;
        this.database.all("SELECT * FROM mesChallenges").then(function (rows) {
            _this.Mychallenges = [];
            for (var row in rows) {
                _this.challenges.push({
                    id: rows[row][0],
                    nom: rows[row][1]
                });
                console.log("id: " + rows[row][0] + "  name: " + rows[row][1]);
            }
        }, function (error) {
            console.log("SELECT ERROR", error);
        });
    };
    ChallengeService.prototype.insertChallenge = function (flight) {
        var _this = this;
        this.database.execSQL("INSERT INTO challenges (name) VALUES (?)", [flight.nom]).then(function (id) {
            console.log("INSERT RESULT", id);
            _this.getAllChallenges();
        }, function (error) {
            console.log("INSERT ERROR", error);
        });
    };
    ChallengeService.prototype.insertMyChallenge = function (flight) {
        var _this = this;
        this.database.execSQL("INSERT INTO mesChallenges (nom) VALUES (?)", [flight.nom]).then(function (id) {
            console.log("INSERT RESULT", id);
            _this.getAllChallenges();
        }, function (error) {
            console.log("INSERT ERROR", error);
        });
    };
    ChallengeService.prototype.deleteAll = function () {
        var _this = this;
        this.database.execSQL("DELETE FROM challenges").then(function (id) {
            console.log("Delete RESULT", id);
            _this.getAllChallenges();
        }, function (error) {
            console.log("Delete ERROR", error);
        });
    };
    ChallengeService.prototype.deleteOneChallenge = function (id) {
        var _this = this;
        this.database.execSQL("DELETE FROM challenges WHERE id=?", [id]).then(function (id) {
            console.log("Delete RESULT", id);
            _this.getAllChallenges();
        }, function (error) {
            console.log("Delete ERROR", error);
        });
    };
    ChallengeService.prototype.getChallenges = function () {
        this.getAllChallenges();
        return this.challenges;
    };
    ChallengeService.prototype.getMyChallenges = function () {
        this.getAllMyChallenges();
        return this.Mychallenges;
    };
    ChallengeService.prototype.getChallenge = function (id) {
        console.log("id: " + id);
        return this.challenges.filter(function (tasks) { return tasks.id == id; })[0];
    };
    ChallengeService = __decorate([
        core_1.Injectable(), 
        __metadata('design:paramtypes', [])
    ], ChallengeService);
    return ChallengeService;
}());
exports.ChallengeService = ChallengeService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2hhbGxlbmdlU2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkNoYWxsZW5nZVNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHFCQUF5QixlQUFlLENBQUMsQ0FBQTtBQUV6QyxJQUFJLE1BQU0sR0FBRyxPQUFPLENBQUMscUJBQXFCLENBQUMsQ0FBQztBQUU1QztJQU1BO1FBTkEsaUJBb0lDO1FBN0hDLEVBQUUsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUNoQyxDQUFDO1lBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUFBLENBQUM7UUFDcEMsQ0FBQyxJQUFJLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFBLEVBQUU7WUFDN0IsRUFBRSxDQUFDLE9BQU8sQ0FBQyw2QkFBNkI7Z0JBQ3hDLG1EQUFtRDtnQkFDbkQsYUFBYSxDQUFDO2lCQUNiLElBQUksQ0FBQyxVQUFBLEVBQUU7Z0JBQ0osS0FBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7Z0JBRXBCLEtBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBQzNCLENBQUMsRUFBRSxVQUFBLEtBQUs7Z0JBQ0osT0FBTyxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUM3QyxDQUFDLENBQUMsQ0FBQztRQUNQLENBQUMsRUFBRSxVQUFBLEtBQUs7WUFDSixPQUFPLENBQUMsR0FBRyxDQUFDLGVBQWUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN4QyxDQUFDLENBQUMsQ0FBQztRQUNILENBQUMsSUFBSSxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQSxFQUFFO1lBQzdCLEVBQUUsQ0FBQyxPQUFPLENBQUMsNkJBQTZCO2dCQUN4QyxtREFBbUQ7Z0JBQ25ELGFBQWEsQ0FBQztpQkFDYixJQUFJLENBQUMsVUFBQSxFQUFFO2dCQUNKLEtBQUksQ0FBQyxRQUFRLEdBQUcsRUFBRSxDQUFDO2dCQUVwQixLQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztZQUMzQixDQUFDLEVBQUUsVUFBQSxLQUFLO2dCQUNKLE9BQU8sQ0FBQyxHQUFHLENBQUMsb0JBQW9CLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDN0MsQ0FBQyxDQUFDLENBQUM7UUFDUCxDQUFDLEVBQUUsVUFBQSxLQUFLO1lBQ0osT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDeEMsQ0FBQyxDQUFDLENBQUM7SUFFTCxDQUFDO0lBRU0sMkNBQWdCLEdBQXZCO1FBQUEsaUJBYUM7UUFaQyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFBLElBQUk7WUFDbkQsS0FBSSxDQUFDLFVBQVUsR0FBRyxFQUFFLENBQUM7WUFDckIsR0FBRyxDQUFBLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQztnQkFDbEIsS0FBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUM7b0JBQ25CLEVBQUUsRUFBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUNmLEdBQUcsRUFBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO2lCQUNuQixDQUFDLENBQUM7Z0JBQ0gsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFFLFVBQVUsR0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUksQ0FBQztZQUNuRSxDQUFDO1FBQ0wsQ0FBQyxFQUFFLFVBQUEsS0FBSztZQUNKLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVNLDZDQUFrQixHQUF6QjtRQUFBLGlCQWFDO1FBWkMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsNkJBQTZCLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQSxJQUFJO1lBQ3RELEtBQUksQ0FBQyxZQUFZLEdBQUcsRUFBRSxDQUFDO1lBQ3ZCLEdBQUcsQ0FBQSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUM7Z0JBQ2xCLEtBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDO29CQUNuQixFQUFFLEVBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDZixHQUFHLEVBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztpQkFDbkIsQ0FBQyxDQUFDO2dCQUNILE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRSxVQUFVLEdBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFJLENBQUM7WUFDbkUsQ0FBQztRQUNMLENBQUMsRUFBRSxVQUFBLEtBQUs7WUFDSixPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN2QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCwwQ0FBZSxHQUFmLFVBQWdCLE1BQWdCO1FBQWhDLGlCQU9DO1FBTkMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsMENBQTBDLEVBQUUsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQSxFQUFFO1lBQ25GLE9BQU8sQ0FBQyxHQUFHLENBQUMsZUFBZSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ25DLEtBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQzFCLENBQUMsRUFBRSxVQUFBLEtBQUs7WUFDSixPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN2QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFHRCw0Q0FBaUIsR0FBakIsVUFBa0IsTUFBZ0I7UUFBbEMsaUJBT0M7UUFOQyxJQUFJLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyw0Q0FBNEMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFBLEVBQUU7WUFDckYsT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDbkMsS0FBSSxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDMUIsQ0FBQyxFQUFFLFVBQUEsS0FBSztZQUNKLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELG9DQUFTLEdBQVQ7UUFBQSxpQkFRQztRQVBDLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLHdCQUF3QixDQUFDLENBQUMsSUFBSSxDQUFDLFVBQUEsRUFBRTtZQUNuRCxPQUFPLENBQUMsR0FBRyxDQUFDLGVBQWUsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUNqQyxLQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUU1QixDQUFDLEVBQUUsVUFBQSxLQUFLO1lBQ0osT0FBTyxDQUFDLEdBQUcsQ0FBQyxjQUFjLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDdkMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsNkNBQWtCLEdBQWxCLFVBQW1CLEVBQVM7UUFBNUIsaUJBV0M7UUFWQSxJQUFJLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxtQ0FBbUMsRUFBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQUEsRUFBRTtZQUNsRSxPQUFPLENBQUMsR0FBRyxDQUFDLGVBQWUsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUNqQyxLQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUU1QixDQUFDLEVBQUUsVUFBQSxLQUFLO1lBQ0osT0FBTyxDQUFDLEdBQUcsQ0FBQyxjQUFjLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDdkMsQ0FBQyxDQUFDLENBQUM7SUFJTCxDQUFDO0lBR0Qsd0NBQWEsR0FBYjtRQUNDLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ3ZCLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDO0lBQ3pCLENBQUM7SUFFRCwwQ0FBZSxHQUFmO1FBQ0MsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7UUFDekIsTUFBTSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUM7SUFDM0IsQ0FBQztJQUVELHVDQUFZLEdBQVosVUFBYSxFQUFTO1FBQ3BCLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxHQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3ZCLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxVQUFBLEtBQUssSUFBRSxPQUFBLEtBQUssQ0FBQyxFQUFFLElBQUUsRUFBRSxFQUFaLENBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3hELENBQUM7SUEvSEQ7UUFBQyxpQkFBVSxFQUFFOzt3QkFBQTtJQXFJYix1QkFBQztBQUFELENBQUMsQUFwSUQsSUFvSUM7QUFwSVksd0JBQWdCLG1CQW9JNUIsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7SW5qZWN0YWJsZX0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcbmltcG9ydCB7Q2hhbGxlbmdlfSBmcm9tIFwiLi9jaGFsbGVuZ2VcIlxudmFyIFNxbGl0ZSA9IHJlcXVpcmUoXCJuYXRpdmVzY3JpcHQtc3FsaXRlXCIpO1xuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIENoYWxsZW5nZVNlcnZpY2Uge1xuXG5jaGFsbGVuZ2VzOkNoYWxsZW5nZVtdO1xuXG5NeWNoYWxsZW5nZXM6Q2hhbGxlbmdlW107XG5kYXRhYmFzZTphbnk7XG5jb25zdHJ1Y3Rvcigpe1xuICBpZiAoIVNxbGl0ZS5leGlzdHMoXCJleGFtZW4uZGJcIikpXG4gIHsgU3FsaXRlLmNvcHlEYXRhYmFzZShcImV4YW1lbi5kYlwiKTt9XG4gIChuZXcgU3FsaXRlKFwiZXhhbWVuLmRiXCIpKS50aGVuKGRiID0+IHtcbiAgICAgIGRiLmV4ZWNTUUwoXCJDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBcIitcbiAgICAgIFwiY2hhbGxlbmdlcyAoaWQgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULFwiK1xuICAgICAgXCIgIG5vbSBURVhUKVwiKVxuICAgICAgLnRoZW4oaWQgPT4ge1xuICAgICAgICAgIHRoaXMuZGF0YWJhc2UgPSBkYjtcblxuICAgICAgICAgdGhpcy5nZXRBbGxDaGFsbGVuZ2VzKCk7XG4gICAgICB9LCBlcnJvciA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJDUkVBVEUgVEFCTEUgRVJST1JcIiwgZXJyb3IpO1xuICAgICAgfSk7XG4gIH0sIGVycm9yID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwiT1BFTiBEQiBFUlJPUlwiLCBlcnJvcik7XG4gIH0pO1xuICAobmV3IFNxbGl0ZShcImV4YW1lbi5kYlwiKSkudGhlbihkYiA9PiB7XG4gICAgICBkYi5leGVjU1FMKFwiQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgXCIrXG4gICAgICBcImNoYWxsZW5nZXMgKGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCxcIitcbiAgICAgIFwiICBub20gVEVYVClcIilcbiAgICAgIC50aGVuKGlkID0+IHtcbiAgICAgICAgICB0aGlzLmRhdGFiYXNlID0gZGI7XG5cbiAgICAgICAgIHRoaXMuZ2V0QWxsQ2hhbGxlbmdlcygpO1xuICAgICAgfSwgZXJyb3IgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ1JFQVRFIFRBQkxFIEVSUk9SXCIsIGVycm9yKTtcbiAgICAgIH0pO1xuICB9LCBlcnJvciA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhcIk9QRU4gREIgRVJST1JcIiwgZXJyb3IpO1xuICB9KTtcblxufVxuXG5wdWJsaWMgZ2V0QWxsQ2hhbGxlbmdlcygpe1xuICB0aGlzLmRhdGFiYXNlLmFsbChcIlNFTEVDVCAqIEZST00gY2hhbGxlbmdlc1wiKS50aGVuKHJvd3MgPT4ge1xuICAgICAgdGhpcy5jaGFsbGVuZ2VzID0gW107XG4gICAgICBmb3IodmFyIHJvdyBpbiByb3dzKSB7XG4gICAgICAgICAgdGhpcy5jaGFsbGVuZ2VzLnB1c2goe1xuICAgICAgICAgICAgaWQ6cm93c1tyb3ddWzBdICxcbiAgICAgICAgICAgIG5vbSA6IHJvd3Nbcm93XVsxXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiaWQ6IFwiKyAgcm93c1tyb3ddWzBdICtcIiAgbmFtZTogXCIrcm93c1tyb3ddWzFdICAgKTtcbiAgICAgIH1cbiAgfSwgZXJyb3IgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJTRUxFQ1QgRVJST1JcIiwgZXJyb3IpO1xuICB9KTtcbn1cblxucHVibGljIGdldEFsbE15Q2hhbGxlbmdlcygpe1xuICB0aGlzLmRhdGFiYXNlLmFsbChcIlNFTEVDVCAqIEZST00gbWVzQ2hhbGxlbmdlc1wiKS50aGVuKHJvd3MgPT4ge1xuICAgICAgdGhpcy5NeWNoYWxsZW5nZXMgPSBbXTtcbiAgICAgIGZvcih2YXIgcm93IGluIHJvd3MpIHtcbiAgICAgICAgICB0aGlzLmNoYWxsZW5nZXMucHVzaCh7XG4gICAgICAgICAgICBpZDpyb3dzW3Jvd11bMF0gLFxuICAgICAgICAgICAgbm9tIDogcm93c1tyb3ddWzFdXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJpZDogXCIrICByb3dzW3Jvd11bMF0gK1wiICBuYW1lOiBcIityb3dzW3Jvd11bMV0gICApO1xuICAgICAgfVxuICB9LCBlcnJvciA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhcIlNFTEVDVCBFUlJPUlwiLCBlcnJvcik7XG4gIH0pO1xufVxuXG5pbnNlcnRDaGFsbGVuZ2UoZmxpZ2h0OkNoYWxsZW5nZSl7XG4gIHRoaXMuZGF0YWJhc2UuZXhlY1NRTChcIklOU0VSVCBJTlRPIGNoYWxsZW5nZXMgKG5hbWUpIFZBTFVFUyAoPylcIiwgW2ZsaWdodC5ub21dKS50aGVuKGlkID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwiSU5TRVJUIFJFU1VMVFwiLCBpZCk7XG4gICAgdGhpcy5nZXRBbGxDaGFsbGVuZ2VzKCk7XG4gIH0sIGVycm9yID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwiSU5TRVJUIEVSUk9SXCIsIGVycm9yKTtcbiAgfSk7XG59XG5cblxuaW5zZXJ0TXlDaGFsbGVuZ2UoZmxpZ2h0OkNoYWxsZW5nZSl7XG4gIHRoaXMuZGF0YWJhc2UuZXhlY1NRTChcIklOU0VSVCBJTlRPIG1lc0NoYWxsZW5nZXMgKG5vbSkgVkFMVUVTICg/KVwiLCBbZmxpZ2h0Lm5vbV0pLnRoZW4oaWQgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJJTlNFUlQgUkVTVUxUXCIsIGlkKTtcbiAgICB0aGlzLmdldEFsbENoYWxsZW5nZXMoKTtcbiAgfSwgZXJyb3IgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJJTlNFUlQgRVJST1JcIiwgZXJyb3IpO1xuICB9KTtcbn1cblxuZGVsZXRlQWxsKCl7XG4gIHRoaXMuZGF0YWJhc2UuZXhlY1NRTChcIkRFTEVURSBGUk9NIGNoYWxsZW5nZXNcIikudGhlbihpZCA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhcIkRlbGV0ZSBSRVNVTFRcIiwgaWQpO1xuICAgICAgdGhpcy5nZXRBbGxDaGFsbGVuZ2VzKCk7XG5cbiAgfSwgZXJyb3IgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJEZWxldGUgRVJST1JcIiwgZXJyb3IpO1xuICB9KTtcbn1cblxuZGVsZXRlT25lQ2hhbGxlbmdlKGlkOm51bWJlcilcbnt0aGlzLmRhdGFiYXNlLmV4ZWNTUUwoXCJERUxFVEUgRlJPTSBjaGFsbGVuZ2VzIFdIRVJFIGlkPT9cIixbaWRdKS50aGVuKGlkID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwiRGVsZXRlIFJFU1VMVFwiLCBpZCk7XG4gICAgICB0aGlzLmdldEFsbENoYWxsZW5nZXMoKTtcblxuICB9LCBlcnJvciA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhcIkRlbGV0ZSBFUlJPUlwiLCBlcnJvcik7XG4gIH0pO1xuXG5cblxufVxuXG5cbmdldENoYWxsZW5nZXMoKTpDaGFsbGVuZ2VbXXtcblx0dGhpcy5nZXRBbGxDaGFsbGVuZ2VzKCk7XG4gIHJldHVybiB0aGlzLmNoYWxsZW5nZXM7XG59XG5cbmdldE15Q2hhbGxlbmdlcygpOkNoYWxsZW5nZVtde1xuXHR0aGlzLmdldEFsbE15Q2hhbGxlbmdlcygpO1xuICByZXR1cm4gdGhpcy5NeWNoYWxsZW5nZXM7XG59XG5cbmdldENoYWxsZW5nZShpZDpudW1iZXIpOkNoYWxsZW5nZXtcbiAgY29uc29sZS5sb2coXCJpZDogXCIraWQpO1xuICByZXR1cm4gdGhpcy5jaGFsbGVuZ2VzLmZpbHRlcih0YXNrcz0+dGFza3MuaWQ9PWlkKVswXTtcbn1cblxuXG5cblxuXG59XG4iXX0=